import pandas as pd
from io import StringIO

# Input the data in tabular form as a string for parsing
data = """
Date	Open	High	Low	Close 	Adj Close 	Volume
Jan 10, 2025	194.30	196.52	190.31	192.04	192.04	26,653,900
Jan 8, 2025	192.57	196.29	192.38	193.95	193.95	24,864,800
Jan 7, 2025	197.11	201.00	194.60	195.49	195.49	26,487,200
Jan 6, 2025	193.98	198.22	193.85	196.87	196.87	29,563,600
Jan 3, 2025	191.37	193.21	189.98	191.79	191.79	18,596,200
Jan 2, 2025	190.65	192.00	187.50	189.43	189.43	20,370,800
Dec 31, 2024	191.08	191.96	188.51	189.30	189.30	17,466,900
Dec 30, 2024	189.80	192.55	189.12	191.24	191.24	14,264,700
Dec 27, 2024	194.95	195.32	190.65	192.76	192.76	18,891,400
Dec 26, 2024	195.15	196.75	194.38	195.60	195.60	12,046,600
Dec 24, 2024	194.84	196.11	193.78	196.11	196.11	10,403,300
Dec 23, 2024	192.62	195.10	190.15	194.63	194.63	25,675,000
Dec 20, 2024	185.78	192.89	185.22	191.41	191.41	63,462,900
Dec 19, 2024	191.63	193.03	188.38	188.51	188.51	32,265,200
Dec 18, 2024	195.22	197.00	187.74	188.40	188.40	34,166,100
Dec 17, 2024	197.25	201.42	194.98	195.42	195.42	43,504,000
Dec 16, 2024	192.87	199.00	192.62	196.66	196.66	44,934,900
Dec 13, 2024	191.01	192.73	189.64	189.82	189.82	25,143,500
Dec 12, 2024	195.00	195.18	191.71	191.96	191.96	34,817,500
Dec 11, 2024	185.31	195.61	184.85	195.40	195.40	67,894,100
Dec 10, 2024	182.85	186.36	181.05	185.17	185.17	54,813,000
Dec 9, 2024	0.20 Dividend
Dec 9, 2024	173.96	176.26	173.65	175.37	175.37	25,389,600
Dec 6, 2024	172.03	175.08	171.86	174.71	174.51	21,462,400
Dec 5, 2024	175.36	176.06	172.33	172.64	172.44	21,356,200
Dec 4, 2024	171.15	174.91	171.06	174.37	174.17	31,615,100
Dec 3, 2024	171.49	172.68	170.85	171.34	171.14	22,248,700
Dec 2, 2024	168.77	172.08	168.57	171.49	171.29	23,789,100
Nov 29, 2024	168.50	169.43	167.16	168.95	168.76	14,257,200
Nov 27, 2024	169.00	169.48	168.02	169.23	169.04	19,266,500
Nov 26, 2024	167.63	169.82	167.58	169.12	168.93	20,486,700
Nov 25, 2024	166.09	168.63	165.61	167.65	167.46	33,135,300
Nov 22, 2024	165.85	166.46	163.90	164.76	164.57	38,604,600
Nov 21, 2024	173.90	174.13	163.70	167.63	167.44	59,734,400
Nov 20, 2024	177.34	177.68	173.78	175.98	175.78	18,997,100
Nov 19, 2024	173.72	178.87	173.56	178.12	177.92	23,434,900
Nov 18, 2024	173.42	175.44	172.90	175.30	175.10	20,206,600
Nov 15, 2024	173.73	174.14	171.22	172.49	172.29	32,504,600
Nov 14, 2024	178.28	178.82	174.32	175.58	175.38	31,007,500
Nov 13, 2024	180.46	180.96	178.54	178.88	178.68	23,184,000
Nov 12, 2024	179.82	182.49	179.39	181.62	181.41	25,134,900
Nov 11, 2024	178.58	180.55	178.47	180.35	180.14	17,450,400
Nov 8, 2024	180.65	180.90	178.08	178.35	178.15	22,006,200
Nov 7, 2024	177.41	181.08	177.19	180.75	180.54	25,352,900
Nov 6, 2024	173.80	176.94	173.50	176.51	176.31	33,695,500
Nov 5, 2024	169.43	170.53	168.84	169.74	169.55	18,242,100
Nov 4, 2024	169.93	170.73	168.01	169.24	169.05	21,492,700
Nov 1, 2024	170.07	172.32	168.88	171.29	171.09	31,796,500
Oct 31, 2024	173.13	176.82	171.00	171.11	170.91	44,769,000
Oct 30, 2024	180.68	182.02	174.06	174.46	174.26	68,890,800
Oct 29, 2024	167.73	170.38	167.09	169.68	169.49	42,169,000
Oct 28, 2024	168.75	168.75	163.95	166.72	166.53	32,138,600
Oct 25, 2024	163.67	165.59	163.42	165.27	165.08	19,828,900
Oct 24, 2024	162.83	163.33	161.01	162.72	162.53	22,412,500
Oct 23, 2024	164.76	165.82	161.93	162.78	162.59	18,280,500
Oct 22, 2024	162.98	165.77	162.98	165.14	164.95	16,568,100
Oct 21, 2024	162.95	164.50	162.62	164.07	163.88	20,946,500
Oct 18, 2024	163.19	164.71	163.08	163.42	163.23	19,757,700
Oct 17, 2024	165.73	166.37	162.76	162.93	162.74	21,453,400
Oct 16, 2024	164.53	165.80	163.74	165.16	164.97	16,406,000
Oct 15, 2024	165.79	167.68	164.63	165.46	165.27	20,247,200
Oct 14, 2024	163.64	166.23	163.40	164.96	164.77	19,016,100
Oct 11, 2024	162.13	163.90	161.24	163.24	163.05	15,344,300
Oct 10, 2024	160.87	163.07	160.40	162.08	161.89	14,144,100
Oct 9, 2024	163.45	164.84	159.74	161.86	161.67	31,181,800
Oct 8, 2024	163.94	164.73	162.87	164.38	164.19	23,072,700
Oct 7, 2024	167.72	168.48	162.75	162.98	162.79	22,463,100
Oct 4, 2024	168.06	168.23	165.48	167.06	166.87	19,047,400
Oct 3, 2024	164.41	166.64	163.92	165.86	165.67	15,073,100
Oct 2, 2024	166.42	167.52	164.73	165.86	165.67	17,760,200
Oct 1, 2024	167.69	169.16	164.58	166.99	166.80	28,338,100
Sep 30, 2024	163.32	166.15	163.26	165.85	165.66	20,413,900
Sep 27, 2024	162.81	165.70	162.63	163.95	163.76	21,101,300
Sep 26, 2024	163.64	164.08	162.28	162.73	162.54	20,319,300
Sep 25, 2024	161.47	162.81	161.30	161.49	161.31	18,869,200
Sep 24, 2024	163.03	163.22	160.69	162.29	162.10	23,332,100
Sep 23, 2024	164.35	165.49	161.67	161.85	161.66	24,150,900
Sep 20, 2024	163.50	163.73	162.06	163.59	163.40	40,896,400
Sep 19, 2024	163.71	163.79	161.34	162.14	161.95	26,587,700
Sep 18, 2024	159.86	160.50	158.60	159.81	159.63	23,677,300
Sep 17, 2024	159.02	160.55	158.38	159.32	159.14	20,715,600
Sep 16, 2024	157.31	158.25	156.60	158.06	157.88	18,379,800
Sep 13, 2024	155.43	158.38	155.21	157.46	157.28	29,591,200
Sep 12, 2024	153.80	154.82	152.65	154.69	154.51	29,695,000
Sep 11, 2024	149.92	151.50	147.52	151.16	150.99	29,607,700
Sep 10, 2024	150.45	151.27	148.34	148.66	148.49	31,118,800
Sep 9, 2024	0.20 Dividend
Sep 9, 2024	152.51	153.40	147.22	148.71	148.54	39,260,500
Sep 6, 2024	157.30	157.83	150.55	150.92	150.55	37,912,100
Sep 5, 2024	156.30	159.45	155.98	157.24	156.85	18,688,700
Sep 4, 2024	156.66	159.00	155.96	156.45	156.06	19,353,800
Sep 3, 2024	161.72	161.85	156.48	157.36	156.97	38,945,300
Aug 30, 2024	162.62	163.66	161.69	163.38	162.98	22,123,800
Aug 29, 2024	164.31	165.97	160.25	161.78	161.38	19,699,800
Aug 28, 2024	165.04	165.60	161.53	162.85	162.45	16,407,400
Aug 27, 2024	165.84	166.44	164.46	164.68	164.27	11,821,900
Aug 26, 2024	166.38	167.55	164.46	166.16	165.75	14,190,400
Aug 23, 2024	164.72	166.18	163.83	165.62	165.21	13,955,700
Aug 22, 2024	167.26	167.59	163.31	163.80	163.40	22,493,300
Aug 21, 2024	165.15	166.85	164.67	165.85	165.44	22,902,000
Aug 20, 2024	166.90	168.64	166.82	167.18	166.77	18,341,500
Aug 19, 2024	165.28	166.69	164.26	166.67	166.26	22,416,200
Aug 16, 2024	161.47	165.06	161.13	162.96	162.56	24,208,600
Aug 15, 2024	160.50	161.64	159.61	161.30	160.90	31,524,300
Aug 14, 2024	162.40	163.22	157.71	160.37	159.97	40,591,100
Aug 13, 2024	163.41	164.73	162.97	164.16	163.75	18,551,700
Aug 12, 2024	164.35	164.90	161.84	162.29	161.89	15,895,300
Aug 9, 2024	160.01	163.79	159.06	163.67	163.27	28,602,300
Aug 8, 2024	160.51	163.69	160.21	162.03	161.63	25,578,800
Aug 7, 2024	161.25	162.98	158.47	158.94	158.55	25,138,600
Aug 6, 2024	159.33	160.57	156.41	158.29	157.90	49,004,600
Aug 5, 2024	155.50	164.43	154.93	159.25	158.86	53,630,700
Aug 2, 2024	166.44	168.51	164.67	166.66	166.25	29,130,100
Aug 1, 2024	170.25	174.05	168.88	170.76	170.34	24,531,400
Jul 31, 2024	173.24	174.25	170.01	171.54	171.12	25,729,100
Jul 30, 2024	170.24	171.23	168.44	170.29	169.87	18,959,700
Jul 29, 2024	168.83	170.43	167.99	169.53	169.11	20,293,800
Jul 26, 2024	167.15	168.09	164.06	167.00	166.59	41,336,900
Jul 25, 2024	172.52	173.42	167.19	167.28	166.87	44,852,000
Jul 24, 2024	173.60	176.19	171.82	172.63	172.20	49,585,200
Jul 23, 2024	182.05	183.61	181.54	181.79	181.34	36,352,700
Jul 22, 2024	180.59	182.70	180.23	181.67	181.22	24,100,300
Jul 19, 2024	178.88	180.29	177.13	177.66	177.22	18,881,900
Jul 18, 2024	181.93	182.50	176.47	177.69	177.25	25,315,700
Jul 17, 2024	182.97	183.55	179.90	181.02	180.57	20,734,100
Jul 16, 2024	187.36	188.68	183.37	183.92	183.47	18,290,700
Jul 15, 2024	184.92	188.24	184.92	186.53	186.07	16,474,000
Jul 12, 2024	185.08	187.11	184.49	185.07	184.61	22,898,400
Jul 11, 2024	189.85	190.86	185.08	185.57	185.11	25,625,800
Jul 10, 2024	189.15	191.75	189.03	191.18	190.71	15,952,500
Jul 9, 2024	190.31	191.36	188.72	188.98	188.51	15,121,400
Jul 8, 2024	189.90	190.17	187.78	189.03	188.56	21,035,900
Jul 5, 2024	185.86	190.86	185.80	190.60	190.13	20,967,500
Jul 3, 2024	184.85	186.09	184.00	185.82	185.36	10,242,100
Jul 2, 2024	182.05	185.57	181.56	185.24	184.78	17,372,500
Jul 1, 2024	183.03	183.88	181.30	182.99	182.54	16,006,100
Jun 28, 2024	184.32	185.13	181.96	182.15	181.70	29,156,600
Jun 27, 2024	184.18	186.05	184.02	185.41	184.95	18,848,900
Jun 26, 2024	182.63	184.51	182.48	183.88	183.43	19,839,000
Jun 25, 2024	179.62	184.29	179.42	184.03	183.58	23,235,600
Jun 24, 2024	180.16	180.89	178.67	179.22	178.78	18,298,000
Jun 21, 2024	177.00	180.85	176.61	179.63	179.19	58,582,700
Jun 20, 2024	175.37	177.29	174.99	176.30	175.86	20,160,100
Jun 18, 2024	177.14	177.39	174.10	175.09	174.66	21,869,900
Jun 17, 2024	175.46	178.36	174.81	177.24	176.80	19,618,500
Jun 14, 2024	174.22	177.06	174.15	176.79	176.35	18,063,600
Jun 13, 2024	176.11	176.74	174.88	175.16	174.73	20,913,300
Jun 12, 2024	178.25	180.41	176.11	177.79	177.35	27,864,700
Jun 11, 2024	176.22	176.84	173.77	176.62	176.18	21,540,600
Jun 10, 2024	0.20 Dividend
Jun 10, 2024	174.97	177.06	172.76	175.01	174.58	23,779,200
Jun 7, 2024	177.05	177.87	174.30	174.46	173.83	19,661,400
Jun 6, 2024	175.90	177.15	175.75	176.73	176.09	23,251,000
Jun 5, 2024	175.20	176.65	173.93	175.41	174.78	22,068,500
Jun 4, 2024	173.28	173.85	171.89	173.79	173.16	26,879,600
Jun 3, 2024	172.54	174.53	171.16	173.17	172.54	27,459,100
May 31, 2024	171.86	173.06	169.44	172.50	171.88	37,638,900
May 30, 2024	175.20	175.22	171.79	172.11	171.49	22,958,700
May 29, 2024	175.43	176.84	174.72	175.90	175.26	23,388,700
May 28, 2024	174.45	177.27	174.37	176.40	175.76	20,572,200
May 24, 2024	174.98	175.77	173.65	174.99	174.36	16,572,500
May 23, 2024	177.07	178.25	172.95	173.55	172.92	21,024,900
May 22, 2024	176.64	177.15	175.21	176.38	175.74	17,880,000
May 21, 2024	176.90	178.15	175.81	177.85	177.21	16,989,400
May 20, 2024	176.19	178.77	176.08	176.92	176.28	22,554,400
May 17, 2024	174.18	176.27	173.69	176.06	175.42	24,479,300
May 16, 2024	173.29	175.12	172.69	174.18	173.55	27,867,900
May 15, 2024	170.63	172.65	170.51	172.51	171.89	26,948,400
May 14, 2024	169.77	171.25	168.80	170.34	169.72	25,127,100
May 13, 2024	164.26	169.28	164.00	169.14	168.53	31,327,600
May 10, 2024	168.03	169.85	166.19	168.65	168.04	29,799,900
May 9, 2024	169.39	170.69	168.18	169.96	169.35	15,346,700
May 8, 2024	169.00	170.15	168.74	169.38	168.77	19,569,100
May 7, 2024	168.50	171.76	168.39	171.25	170.63	28,039,700
May 6, 2024	167.46	168.14	166.03	168.10	167.49	21,871,300
May 3, 2024	167.56	167.96	163.05	167.24	166.64	34,662,400
May 2, 2024	164.79	166.73	163.89	166.62	166.02	24,294,500
May 1, 2024	164.30	167.12	163.09	163.86	163.27	33,493,200
Apr 30, 2024	165.61	168.10	162.60	162.78	162.19	33,562,900
Apr 29, 2024	169.06	169.55	165.21	166.15	165.55	45,610,000
Apr 26, 2024	174.37	174.71	169.65	171.95	171.33	64,665,300
Apr 25, 2024	151.33	156.49	150.87	156.00	155.44	57,109,700
Apr 24, 2024	157.49	159.57	157.17	159.13	158.56	22,779,100
Apr 23, 2024	156.96	158.97	156.28	158.26	157.69	21,151,600
Apr 22, 2024	154.31	157.64	154.06	156.28	155.72	26,446,200
Apr 19, 2024	156.20	156.36	152.30	154.09	153.53	32,239,100
Apr 18, 2024	155.34	156.94	154.62	156.01	155.45	19,883,000
Apr 17, 2024	155.62	157.08	154.58	155.47	154.91	21,763,100
Apr 16, 2024	154.19	155.65	153.43	154.40	153.84	20,779,500
Apr 15, 2024	158.86	159.24	154.59	154.86	154.30	27,136,500
Apr 12, 2024	157.96	160.22	157.14	157.73	157.16	25,329,200
Apr 11, 2024	156.91	159.68	156.46	159.41	158.83	27,166,400
Apr 10, 2024	156.21	156.61	154.68	156.14	155.58	22,838,600
Apr 9, 2024	156.09	158.56	155.19	156.60	156.03	31,113,000
Apr 8, 2024	152.78	155.27	152.61	154.85	154.29	20,702,000
Apr 5, 2024	150.03	153.42	149.60	152.50	151.95	23,449,300
Apr 4, 2024	153.50	154.77	150.45	150.53	149.99	34,724,700
Apr 3, 2024	153.60	155.08	152.73	154.92	154.36	24,705,000
Apr 2, 2024	153.50	154.70	152.15	154.56	154.00	24,586,000
Apr 1, 2024	150.69	155.74	150.61	155.49	154.93	31,730,800
Mar 28, 2024	150.85	151.43	150.17	150.93	150.38	24,485,400
Mar 27, 2024	151.18	151.64	148.90	150.87	150.33	22,879,200
Mar 26, 2024	150.22	152.26	149.98	150.67	150.13	22,149,100
Mar 25, 2024	149.94	150.38	147.82	150.07	149.53	19,229,300
Mar 22, 2024	149.12	151.58	148.98	150.77	150.23	29,175,700
Mar 21, 2024	149.47	150.37	146.90	147.60	147.07	24,755,600
Mar 20, 2024	148.00	148.86	146.74	148.74	148.20	21,311,500
Mar 19, 2024	148.16	148.79	146.08	147.03	146.50	24,070,400
Mar 18, 2024	148.61	152.15	147.17	147.68	147.15	69,273,700
Mar 15, 2024	142.50	143.18	140.03	141.18	140.67	49,460,600
Mar 14, 2024	141.19	143.59	140.46	143.10	142.58	42,753,400
Mar 13, 2024	139.00	141.09	138.99	139.79	139.29	23,347,200
Mar 12, 2024	137.03	139.38	137.03	138.50	138.00	27,563,400
Mar 11, 2024	136.13	139.10	136.13	137.67	137.17	32,437,800
Mar 8, 2024	134.21	138.09	134.00	135.41	134.92	39,343,100
Mar 7, 2024	132.79	134.94	131.61	134.38	133.89	37,738,200
Mar 6, 2024	133.12	133.58	130.85	131.40	130.93	35,318,600
Mar 5, 2024	131.88	133.24	130.67	132.67	132.19	40,194,800
Mar 4, 2024	135.66	135.66	131.91	133.35	132.87	55,999,400
Mar 1, 2024	138.43	138.87	136.92	137.14	136.64	31,119,500
Feb 29, 2024	137.28	138.86	136.40	138.46	137.96	42,133,000
Feb 28, 2024	137.90	138.01	135.41	136.38	135.89	37,328,600
Feb 27, 2024	138.02	139.25	137.09	138.88	138.38	33,099,200
Feb 26, 2024	142.14	142.44	137.39	137.57	137.07	53,641,800
Feb 23, 2024	143.67	144.68	143.43	143.96	143.44	19,493,800
Feb 22, 2024	144.93	145.00	142.80	144.09	143.57	27,191,900
Feb 21, 2024	141.45	142.69	140.68	142.55	142.04	23,315,700
Feb 20, 2024	139.66	142.08	139.49	141.12	140.61	25,144,700
Feb 16, 2024	142.99	143.19	140.14	140.52	140.01	31,451,100
Feb 15, 2024	143.14	143.52	140.46	142.77	142.25	37,590,700
Feb 14, 2024	146.08	146.52	144.09	145.94	145.41	22,704,200
Feb 13, 2024	144.92	146.67	143.69	145.14	144.62	27,837,700
Feb 12, 2024	148.42	149.34	147.37	147.53	147.00	21,564,100
Feb 9, 2024	146.68	149.44	146.18	149.00	148.46	26,829,500
Feb 8, 2024	145.83	146.33	145.10	145.91	145.38	22,563,800
Feb 7, 2024	144.76	145.62	143.93	145.54	145.01	25,208,900
Feb 6, 2024	144.65	145.36	143.19	144.10	143.58	29,128,200
Feb 5, 2024	142.82	145.47	142.78	143.68	143.16	38,505,400
Feb 2, 2024	139.26	142.62	136.50	142.38	141.87	62,470,600
Feb 1, 2024	142.12	143.06	140.79	141.16	140.65	40,466,500
Jan 31, 2024	143.62	144.00	139.87	140.10	139.59	71,910,000
Jan 30, 2024	152.80	153.62	151.19	151.46	150.91	36,331,800
Jan 29, 2024	152.06	153.78	151.43	153.51	152.96	27,784,300
Jan 26, 2024	151.10	152.54	151.01	152.19	151.64	26,115,500
Jan 25, 2024	150.07	153.05	149.54	151.87	151.32	29,149,100
Jan 24, 2024	148.54	149.85	148.10	148.70	148.16	25,233,500
Jan 23, 2024	145.89	147.18	145.50	147.04	146.51	21,636,100
Jan 22, 2024	147.10	148.39	145.84	145.99	145.46	32,200,400
Jan 19, 2024	144.74	146.45	144.38	146.38	145.85	33,300,700
Jan 18, 2024	142.05	144.21	141.99	143.48	142.96	25,746,400
Jan 17, 2024	141.35	141.84	138.90	141.47	140.96	20,968,600
Jan 16, 2024	142.00	144.35	141.45	142.49	141.98	22,670,500
Jan 12, 2024	142.67	143.20	141.82	142.65	142.13	18,768,600
Jan 11, 2024	143.49	145.22	140.64	142.08	141.57	24,008,700
"""

# Parse the data into a pandas DataFrame
df = pd.read_csv(StringIO(data), sep="\t")

# Clean column names to remove trailing spaces
df.columns = df.columns.str.strip()

# Ensure the 'Close' column is numeric
df['Close'] = pd.to_numeric(df['Close'], errors='coerce')

# Sort data by date (assuming Date format is not standardized)
df['Date'] = pd.to_datetime(df['Date'], errors='coerce')
df = df.sort_values('Date')

# Initialize backtest parameters
initial_cash = 100000  # Initial cash in USD
cash = initial_cash
shares = 0
portfolio_values = []  # To track portfolio value over time

# Backtest strategy
for i in range(1, len(df)):
    prev_close = df.iloc[i - 1]['Close']
    current_close = df.iloc[i]['Close']

    # Sell condition: if today's close is higher than yesterday's
    if current_close > prev_close and shares > 0:
        cash += shares * current_close
        shares = 0

    # Buy condition: if today's close is lower than yesterday's
    elif current_close < prev_close and cash > 0:
        shares = cash // current_close
        cash -= shares * current_close

    # Calculate total portfolio value
    portfolio_value = cash + shares * current_close
    portfolio_values.append(portfolio_value)

# Add final portfolio value
final_value = cash + shares * df.iloc[-1]['Close']

print(f"Initial Cash: ${initial_cash:.2f}")
print(f"Final Portfolio Value: ${final_value:.2f}")
print(f"Total Return: {((final_value - initial_cash) / initial_cash) * 100:.2f}%")
